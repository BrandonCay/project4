

/* bn_sample.c */
#include "rsaFunctions.h"
#include <stdio.h>
#include <openssl/bn.h>

#define NBITS 256
void printBN(char *msg, BIGNUM * a)
{
/* Use BN_bn2hex(a) for hex string
* Use BN_bn2dec(a) for decimal string */
    char * number_str = BN_bn2hex(a);
    printf("%s %s\n", msg, number_str);
    OPENSSL_free(number_str);
}

int main ()
{

    BIGNUM *C = BN_new();
    BIGNUM *M = BN_new();
    BIGNUM *e = BN_new();
    BIGNUM *n = BN_new();
    BIGNUM *S = BN_new();

    //BN_hex2bn(&M, "4c61756e63682061206d697373696c652e"); //"Launch a missle."

    BN_hex2bn(&C, "8C0F971DF2F3672B28811407E2DABBE1DA0FEBBBDFC7DCB67396567EA1E2493F");

    BN_hex2bn(&e, "65537");

    BN_hex2bn(&n, "BD4A4350DAD86ADA684EE5AB83B7717999DC8A0F6701C637D60DFE6\
    4153DAC42E872C9F4BDF56B1B0064B7643B13E96E3F205185240B2826A2FE8003AED2\
    50E82CF0E4BB9719281716428711570028CF87EE0919E2150DE7061E576250C1F71CD\
    E1034E205BA047CDDE99E1988D64A2E8F73F84A6F4D1FA3D42A0739D48377D2788AD56\
    8F01CF0FD706492BFE6C92397F6B5468FC4BB5FFDE016C033E922DE771D15C30D46A\
    E4370DA0954944CA8BE98608B3A577B26B401E56AB24015DDE292974C9EDD4D36B512FBB0D0EC8B6D10A61BAE\
    716D4D0D0753BC801AD9986850A00D2BE1858078471752CB8F63D232CAD4A054848A94EB2698DEA3A4E658637489");

    BN_hex2bn(&S, "7466bd6a013940556326d37ff21cbbe05934c56acee72fb3a6262685dd47fd4721400bc12a8b2429249ca575f31a761c1b4c5cb2ae5523af15ad316385b468e70bbfa0eb283c22b \
    131e4c03cd876cf9aa64459093b595586d48624d50ad6a407f8e4c0a075e7d2e7a296c5dcbdc04c \
    78ffd74031a7c548f4cf218fdd4086ede37415dd61dd8aad958264d3fbe6fab3d2f6d181d63a281\
    d075919986795acd7e63ec5cfdeeae8e5de8d6305398a021b50b37fd4979ac136d11168ad058d2e\
    c971e9a3a6c643128f6ce20340be3e656f04c6e1a9c09aed4a739109db20380ef37c64e9186b03bf\
    fe464d6e4f699cd7fa2f1d50df273caca750779b1c9b918df102");

    unsignSignature(C,S,e,n);
//usinged: 0112953A40000504D64AE9D22BD5F0D837AD3EB96269A2F5E7403C89
    printBN("C = ", C);
/*
    if(BN_cmp(C, M) == 0){
        printf("Valid");
    }
    else{
        printf("Fail");
    }
    //deallocate vars
*/
return 0;
}
